# 随机过程课后题第五章答案
## 1

判定一个随机过程 $\{X_n\}$ 是否是马尔可夫链（马氏链），核心标准是看它是否具有**“无后效性”**。

即：推断**“未来”**（$X_{n+1}$）的概率分布，在已知**“现在”**（$X_n$）的情况下，是否还需要参考**“过去”**（$X_{n-1}, \cdots, X_1$）的信息？
* 如果**只需要“现在”**就能完全决定“未来”的分布，则是马氏链。
* 如果**还需要“过去”**来辅助判断，则不是。

我们利用递推关系式法来分别讨论。

---

### (1) $X_n = U_1 + U_2 + \cdots + U_n$

**结论：是马尔可夫链。**

**证明过程：**

1.  **寻找递推关系**：
我们可以将 $X_{n+1}$ 写成 $X_n$ 的函数：
$$
\begin{aligned}
X_{n+1} &= \underbrace{U_1 + U_2 + \cdots + U_n}_{X_n} + U_{n+1} \\
X_{n+1} &= X_n + U_{n+1}
\end{aligned}
$$

2.  **分析依赖性**：
* $X_{n+1}$ 的值取决于当前状态 $X_n$ 和新的增量 $U_{n+1}$。
* 题目已知 $\{U_n\}$ 是**相互独立**的随机变量序列。
* 这意味着，新的增量 $U_{n+1}$ 独立于过去的所有的 $U_1, \dots, U_n$。
* 因为过去的某些状态 $X_{n-1}, \dots, X_1$ 只是 $U_1, \dots, U_{n-1}$ 的组合，所以 $U_{n+1}$ 也独立于过去的所有状态 $(X_1, \dots, X_n)$。

3.  **结论**：
当我们已知“现在”的状态 $X_n = x_n$ 时，“未来” $X_{n+1} = x_n + U_{n+1}$ 的分布完全由 $U_{n+1}$ 的分布决定，与“过去”的历史路径无关。
满足马尔可夫性：
$$P(X_{n+1} | X_n, X_{n-1}, \dots, X_1) = P(X_{n+1} | X_n)$$

这就是典型的**随机游走（Random Walk）**模型，它是最经典的马尔可夫链之一。

---

### (2) $X_n = (U_1 + U_2 + \cdots + U_n)^2$

**结论：一般情况下不是马尔可夫链。**
*(只有在特殊情况下，如 $U_n$ 的分布关于 0 对称时，才可能是)*

**分析与反例：**

1.  **寻找递推关系**：
令 $S_n = U_1 + \cdots + U_n$（即第一问中的随机游走），则 $X_n = S_n^2$。
$$
\begin{aligned}
X_{n+1} &= S_{n+1}^2 = (S_n + U_{n+1})^2 \\
X_{n+1} &= S_n^2 + 2S_n U_{n+1} + U_{n+1}^2 \\
X_{n+1} &= X_n + 2S_n U_{n+1} + U_{n+1}^2
\end{aligned}
$$

2.  **发现问题**：
要确定 $X_{n+1}$ 的分布，我们需要知道 $X_n$ 和 **$S_n$ 的正负号**。
* 已知 $X_n$ (即 $S_n^2$)，我们只能算出 $|S_n|$ 的绝对值，但**不知道 $S_n$ 到底是正还是负**。
* 然而，中间项 $2S_n U_{n+1}$ 的值显然取决于 $S_n$ 的符号。
* 这时候，“过去”的信息（$X_{n-1}$）可能会帮助我们推断出 $S_n$ 的符号，从而改变对未来的预测。

3.  **举反例证明（非马氏性）**：
设 $U_n$ 取值非对称，例如：$P(U_n = 1) = \frac{2}{3}, P(U_n = -1) = \frac{1}{3}$。

假设当前状态 **$X_n = 1$**。这意味着 $S_n$ 可能是 $1$ 或 $-1$。
我们需要预测下一时刻 **$X_{n+1} = 0$** 的概率。
注：$X_{n+1}=0$ 意味着 $(S_n + U_{n+1})^2 = 0$，即 $U_{n+1} = -S_n$。

* **情况 A：如果历史告诉我们 $S_n = 1$**
（例如通过 $X_{n-1}$ 推断出来的）。
要跳到 0，需要 $U_{n+1} = -1$。
概率为：$P(U_{n+1}=-1) = \mathbf{\frac{1}{3}}$。

* **情况 B：如果历史告诉我们 $S_n = -1$**。
要跳到 0，需要 $U_{n+1} = 1$。
概率为：$P(U_{n+1}=1) = \mathbf{\frac{2}{3}}$。

**显而易见**：
虽然“现在”的状态都是 $X_n=1$，但如果你知道“过去”的信息导致判定 $S_n$ 符号不同，预测“未来”的概率（$1/3$ vs $2/3$）就不同了。

$$P(X_{n+1}|X_n, X_{n-1}) \neq P(X_{n+1}|X_n)$$

所以，一般情况下它**不是**马尔可夫链。

**补充说明（特殊情况）：**
如果 $U_n$ 的分布是**关于 0 对称**的（例如取 $\pm 1$ 的概率都是 $0.5$），那么 $S_n$ 为正或为负时，下一步 $X_{n+1}$ 的分布是一样的（因为对称性消除了符号的影响）。在这种特殊情况下，它会变成马氏链。但题目问的是一般情况，答案应为**否**。